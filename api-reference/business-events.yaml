openapi: 3.0.3
info:
  title: MoEngage Business Events API
  description: API for creating, triggering, and searching business events in MoEngage.
  version: '1.0'
servers:
  - url: 'https://api-0{X}.moengage.com/v1.0'
    description: MoEngage API Server
    variables:
      X:
        default: '1'
        description: 'Your MoEngage Data Center (DC) number. Refer to MoEngage docs for your correct DC.'
tags:
  - name: Business Events
    description: Manage and trigger business events.
security:
  - basicAuth: []
paths:
  /business_event:
    post:
      tags:
        - Business Events
      summary: Create Business Event
      description: This API allows you to create business events in MoEngage. You can use these events to trigger campaigns whenever they occur.
      operationId: createBusinessEvent
      requestBody:
        description: Business event definition.
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - event_name
                - event_attributes
                - created_by
              properties:
                event_name:
                  type: string
                  description: This field contains the name of the business event.
                  example: NameOfOTTSeries
                event_attributes:
                  type: array
                  description: This field contains the event attributes of the business event being created.
                  items:
                    $ref: '#/components/schemas/EventAttributeDefinition'
                created_by:
                  type: string
                  format: email
                  description: The email address of the creator of the business event.
                  example: john.doe@example.com
            example:
              event_name: NameOfOTTSeries
              event_attributes:
                - attribute_name: season
                  attribute_data_type: string
                - attribute_name: episodes
                  attribute_data_type: int
                - attribute_name: cast
                  attribute_data_type: array
                - attribute_name: released_on
                  attribute_data_type: date
                - attribute_name: budget
                  attribute_data_type: float
              created_by: john.doe@example.com
      responses:
        '200':
          description: The business event has been created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The business event has been created
                  event_id:
                    type: string
                    description: Unique identifier for the created business event.
                    example: 64a40cff5547a6b2c5b14404
        '400':
          description: Bad Request (e.g., missing parameters, invalid values).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                missingField:
                  summary: Missing mandatory field
                  value:
                    error:
                      code: 400 Bad Request
                      message: Bad request
                      details:
                        - code: MissingValue
                          target: created_by
                          message: 'created_by - Field is required but value is None : None'
                      request_id: 64a54b0f633fda13b6681259
                invalidDataType:
                  summary: Incorrect data type
                  value:
                    error:
                      code: 400 Bad Request
                      message: Bad request
                      details:
                        - code: MissingValue
                          target: brand
                          message: "['brand'] - Wrong Attribute data type is passed : 'String'"
                      request_id: 64a54b6c633fda13b668125e
        '401':
          description: Authorization Failure.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                missingHeader:
                  summary: Missing auth header
                  value:
                    error:
                      code: 401 Authentication error
                      message: Authentication required
                      details:
                        - code: InvalidValue
                          target: Authorization
                          message:
                            code: MissingValue
                            target: Authorization
                            message: APP_ID and APP_SECRET_KEY is missing in Authorization Header.
                      request_id: 64a54b9d633fda13b6681261
                invalidAppId:
                  summary: Invalid App ID
                  value:
                    error:
                      code: 401 Authentication error
                      message: Authentication required
                      details:
                        - code: InvalidValue
                          target: APP_ID
                          message:
                            - code: InvalidValue
                              target: APP_ID
                              message: Invalid APP_ID is provided.
                      request_id: 64a54bfa633fda13b6681262
        '500':
          description: Internal Server Error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  title:
                    type: string
                    example: Internal Server Error
                  message:
                    type: string
                    example: An unexpected error was encountered while processing this request. Please contact MoEngage Team
  /business_event/trigger:
    post:
      tags:
        - Business Events
      summary: Trigger Business Event
      description: This API allows you to trigger a business event in MoEngage. You can set up campaigns to be executed when these events are triggered.
      operationId: triggerBusinessEvent
      requestBody:
        description: Event to trigger.
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - event_name
                - event_attributes
              properties:
                event_name:
                  type: string
                  description: The name of the business event to be triggered.
                  example: Series_Name
                event_attributes:
                  type: object
                  description: A JSON object containing the attributes and their values for the event.
                  additionalProperties: true
                  example:
                    season: Season 1
                    episodes: 12
                    cast:
                      - John Doe
                      - Jane Doe
                    date: '11/11/2023'
                triggered_by:
                  type: string
                  format: email
                  description: Information about who triggered the business event.
                  example: john.doe@example.com
            example:
              event_name: Series_Name
              event_attributes:
                season: Season 1
                episodes: 12
                cast:
                  - John Doe
                  - Jane Doe
                date: '11/11/2023'
              triggered_by: john.doe@example.com
      responses:
        '200':
          description: The business event has been triggered.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The business event has been triggered
        '400':
          description: Bad Request (e.g., event does not exist, no active campaign).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                eventNotFound:
                  summary: Event does not exist
                  value:
                    error:
                      code: 400 Bad Request
                      message: Business event does not exists
                      details:
                        - code: InvalidValue
                          target: event_name
                          message: Business event does not exist
                      request_id: 64a54cf9633fda13b668132f
                noActiveCampaign:
                  summary: No active campaign found
                  value:
                    error:
                      code: 400 Bad Request
                      message: No active campaign found for business event name
                      details:
                        - code: InvalidValue
                          target: event_name
                          message: No active campaign found for business event name
                      request_id: 64a54dbf633fda13b668142d
        '401':
          description: Authorization Failure.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  code: 401 Authentication error
                  message: Authentication required
                  details:
                    - code: InvalidValue
                      target: Authorization
                      message:
                        code: MissingValue
                        target: Authorization
                        message: APP_ID and APP_SECRET_KEY is missing in Authorization Header.
                  request_id: 64a54e0e633fda13b6681430
        '429':
          description: Rate Limit Breach.
          content:
            application/json:
              schema:
                type: object
              example:
                status: error
                data:
                  code: 429
                  title: rate limiter exception
                  description: Exceeded rate limit for this app
        '500':
          description: Internal Server Error.
          content:
            application/json:
              schema:
                type: object
              example:
                title: Internal Server Error
                message: An unexpected error was encountered while processing this request. Please contact MoEngage Team
  /business_event/search:
    post:
      tags:
        - Business Events
      summary: Search Business Events
      description: This API allows you to search for business events by specifying their event IDs or names.
      operationId: searchBusinessEvents
      requestBody:
        description: Search criteria. At least one of event_ids or event_names should be provided.
        content:
          application/json:
            schema:
              type: object
              properties:
                event_ids:
                  type: array
                  items:
                    type: string
                  description: A list of event IDs to search for.
                  example:
                    - 6447b078712cd8c650074840
                event_names:
                  type: array
                  items:
                    type: string
                  description: A list of event names to search for.
                  example:
                    - NewMovies
            example:
              event_ids:
                - 6447b078712cd8c650074840
      responses:
        '200':
          description: A list of found business events.
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BusinessEvent'
              example:
                data:
                  - db_name: Sample_App
                    event_id: 647597767459c85d7d6d6dfd
                    event_name: NewMovies
                    event_attributes:
                      - attribute_name: MovieName
                        attribute_data_type: array
                      - attribute_name: rating
                        attribute_data_type: string
                    created_at: '2023-05-29T18:36:52.390000'
                    total_trigger: 0
                    users_in_segment: 0
                    usage_count: 0
                    created_by: john.doe@moengage.com
                    last_received_time: '2023-05-30T06:28:06.498000'
                    _id: 64a54500633fda13b6681163
        '400':
          description: Bad Request (e.g., additional fields).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  code: 400 Bad Request
                  message: 'Additional fields are not allowed document schema for class BusinessEventSearchRequest:event_name'
                  details:
                    - code: InvalidValue
                      target: event_name
                      message: 'Additional fields are not allowed document schema for class BusinessEventSearchRequest:event_name'
                  request_id: 64a54e62633fda13b6681431
        '401':
          description: Authorization Failure.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  code: 401 Authentication error
                  message: Authentication required
                  details:
                    - code: InvalidValue
                      target: Authorization
                      message:
                        code: MissingValue
                        target: Authorization
                        message: APP_ID and APP_SECRET_KEY is missing in Authorization Header.
                  request_id: 64a54e0e633fda13b6681430
        '429':
          description: Rate Limit Breach.
          content:
            application/json:
              schema:
                type: object
              example:
                status: error
                data:
                  code: 429
                  title: rate limiter exception
                  description: Exceeded rate limit for this app
        '500':
          description: Internal Server Error.
          content:
            application/json:
              schema:
                type: object
              example:
                title: Internal Server Error
                message: An unexpected error was encountered while processing this request. Please contact MoEngage Team
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
      description: 'Basic Authentication using Workspace ID (username) and API Key (password) from MoEngage Dashboard > Settings > Account > APIs.'
  schemas:
    EventAttributeDefinition:
      type: object
      description: Definition of an attribute for a business event.
      required:
        - attribute_name
        - attribute_data_type
      properties:
        attribute_name:
          type: string
          description: The name of the attribute.
          example: season
        attribute_data_type:
          type: string
          description: The data type of the attribute.
          enum:
            - string
            - int
            - float
            - array
            - date
          example: string
    BusinessEvent:
      type: object
      description: A full business event object.
      properties:
        db_name:
          type: string
          description: Name of the database.
          example: Sample_App
        event_id:
          type: string
          description: Unique identifier for the business event.
          example: 647597767459c85d7d6d6dfd
        event_name:
          type: string
          description: Name of the business event.
          example: NewMovies
        event_attributes:
          type: array
          items:
            $ref: '#/components/schemas/EventAttributeDefinition'
        created_at:
          type: string
          format: date-time
          description: Timestamp of when the event was created.
        last_updated:
          type: string
          format: date-time
          description: Timestamp of when the event was last updated.
        total_trigger:
          type: integer
          description: Number of times the event has been triggered.
          example: 0
        total_sent_message:
          type: integer
          description: Number of campaign messages sent for this event.
        users_in_segment:
          type: integer
          description: Number of users in the segment (from example).
          example: 0
        usage_count:
          type: integer
          example: 0
        created_by:
          type: string
          format: email
          description: Email of the event creator.
          example: john.doe@moengage.com
        last_received_time:
          type: string
          format: date-time
          description: Timestamp of when the event was last triggered.
        _id:
          type: string
          description: Internal database ID.
          example: 64a54500633fda13b6681163
    ErrorResponse:
      type: object
      description: Standard error response for 4xx errors.
      properties:
        error:
          type: object
          properties:
            code:
              type: string
              example: 400 Bad Request
            message:
              type: string
              example: Bad request
            details:
              type: array
              items:
                type: object
                properties:
                  code:
                    type: string
                    example: InvalidValue
                  target:
                    type: string
                    example: event_name
                  message:
                    type: string
                    example: Business event does not exist
            request_id:
              type: string
              example: 64a54cf9633fda13b668132f