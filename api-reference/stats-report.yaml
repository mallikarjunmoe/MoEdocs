openapi: 3.0.3
info:
  title: MoEngage Campaign Stats and Reports API
  description: API for fetching detailed campaign stats and downloading campaign reports.
  version: '1.0'
servers:
  - url: 'https://api-0{X}.moengage.com/core-services/v1'
    description: MoEngage Core Services API Server (for Stats)
    variables:
      X:
        default: '1'
        description: 'Your MoEngage Data Center (DC) number. Refer to MoEngage docs for your correct DC.'
  - url: 'https://api.moengage.com'
    description: MoEngage Campaign Reports API Server
tags:
  - name: Stats
    description: Fetch detailed, real-time campaign statistics.
  - name: Campaign Reports
    description: Download campaign report files.
paths:
  /campaign-stats:
    post:
      tags:
        - Stats
      summary: Get Campaign Stats
      description: Allows you to fetch detailed campaign stats synchronized in real time. This API fetches data at the platform level and provides data for all types of campaigns.
      operationId: getCampaignStats
      security:
        - basicAuth: []
      parameters:
        - name: MOE-APPKEY
          in: header
          required: true
          schema:
            type: string
          description: 'This is the workspace ID (earlier APP ID) of your MoEngage workspace. Found in Settings -> Account -> APIs -> Workspace ID.'
          example: 'YOUR_WORKSPACE_ID_XXXX'
      requestBody:
        $ref: '#/components/requestBodies/CampaignStatsRequest'
      responses:
        '200':
          description: Successful response containing campaign stats.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignStatsResponse'
              examples:
                android-push-stats:
                  summary: Example for Android Push
                  value:
                    response_id: 'abc'
                    total_campaigns: 1
                    current_page: 1
                    total_pages: 1
                    data:
                      '66e933029ff25f3322d8279d':
                        - platforms:
                            android:
                              locales:
                                all_locales:
                                  variations:
                                    all_variations:
                                      performance_stats:
                                        attempted: 2
                                        sent: 2
                                        failed: 0
                                        impression: 2
                                        click: 4
                                        ctr: 200
                                        delivery_rate: 100
                                        sent_rate: 100
                                        failure_rate: 0
                                      conversion_goal_stats:
                                        'Goal 1':
                                          conversions: 0
                                          cvr: 0
                                          uplift: 0
                                      delivery_funnel:
                                        reachable_users_in_segment: 2
                                        segment_after_uninstall: 2
                                        after_fc: 2
                                        users_after_dup: 2
                                        sent: 2
                                        user_devices: 2
                                        impressions: 2
                                        active_device_token: 2
                                      failure_breakdown: {}
                                    campaign_control_group:
                                      conversion_goal_stats:
                                        'Goal 1':
                                          conversions: 0
                                          cvr: 0
                                          uplift: 0
                                      delivery_funnel:
                                        reachable_users_in_segment: 0
                                      failure_breakdown:
                                        user_removed_due_to_campaing_control_group: 1
                                    global_control_group:
                                      conversion_goal_stats:
                                        'Goal 1':
                                          conversions: 0
                                          cvr: 0
                                          uplift: 0
                                      delivery_funnel:
                                        reachable_users_in_segment: 0
                                      failure_breakdown:
                                        user_removed_due_to_global_control_group: 1
                email-stats:
                  summary: Example for Email
                  value:
                    response_id: abc
                    total_campaigns: 1
                    current_page: 1
                    total_pages: 1
                    data:
                      '6763f09a1f53871780a63623':
                        - platforms:
                            EMAIL:
                              locales:
                                all_locale:
                                  variations:
                                    all_variations:
                                      performance_stats:
                                        attempted: 338095
                                        sent: 330285
                                        open: 138131
                                        delivered: 321226
                                        click: 51
                                        unsubscribe: 135
                                        complaint: 1
                                        hard_bounce: 4
                                        soft_bounce: 9071
                                        bounce: 9075
                                        failed: 5695
                                        ctr: 0.02
                                        open_rate: 38.18
                                        delivery_rate: 97.26
                                        ctor: 0.03
                                        unsub_rate: 0.04
                                        bounce_rate: 2.75
                                        complaints_rate: 0
                                        sent_rate: 97.69
                                        failure_rate: 1.68
                                      conversion_goal_stats:
                                        'Order Confirmation Status':
                                          goal_name: 'Goal 1'
                                      delivery_funnel:
                                        sent: 330285
                                        user_with_email: 338095
                                        user_with_email_after__h_b: 333017
                                        user_after_duplicate_removal: 330285
                                        after_invalid_removal: 330285
                                        after_fc: 330285
                                        delivered: 321226
                                      failure_breakdown:
                                        'bounces,__unsubscribes,__complaints_removed': 5078
                                        duplicate__emails_removed: 617
                                    global_control_group:
                                      conversion_goal_stats:
                                        'Order Confirmation Status':
                                          goal_name: 'Goal 1'
                                      delivery_funnel: {}
                                      failure_breakdown:
                                        users_removed_due_to__global__control__group: 2100
        '400':
          $ref: '#/components/responses/Error400Stats'
        '401':
          $ref: '#/components/responses/Error401Stats'
        '403':
          $ref: '#/components/responses/Error403Stats'
        '429':
          $ref: '#/components/responses/Error429Stats'
        '500':
          $ref: '#/components/responses/Error500Stats'
  /campaign_reports/rest_api/{APP_ID}/{FILENAME}:
    get:
      tags:
        - Campaign Reports
      summary: Download Campaign Report
      description: 'Download a campaign report file. The API uses a custom Signature header for authentication, generated by hashing (SHA256) a combination of your API_ID, the FILENAME, and your SECRET_KEY.'
      operationId: downloadCampaignReport
      security:
        - apiKeySignature: []
      parameters:
        - name: APP_ID
          in: path
          required: true
          schema:
            type: string
          description: 'Your MoEngage App ID (Workspace ID).'
          example: 'YOUR-APP-ID'
        - name: FILENAME
          in: path
          required: true
          schema:
            type: string
          description: 'The name of the report file to download (e.g., Report_-_test_20210217.zip).'
          example: 'Report_-_test_20210217.zip'
      responses:
        '200':
          description: Successful API request. The report file is returned.
          content:
            application/gzip:
              schema:
                type: string
                format: binary
        '400':
          description: 'Bad Request. Invalid report file name, file name format, report is older than 7 days, or incorrect App Id.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponseCampaignReport'
        '401':
          description: 'Unauthorized. Invalid Signature or Signature Missing.'
          content:
            application/json:
              schema:
                type: object
                description: Empty body.
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
      description: 'Basic Authentication using Workspace ID (username) and Campaign Report API Key (password) from MoEngage Dashboard > Settings > Account > APIs.'
    apiKeySignature:
      type: apiKey
      in: header
      name: Signature
      description: 'A custom signature generated by SHA256(Api_ID + "|" + FILENAME + "|" + SECRET_KEY).'
  requestBodies:
    CampaignStatsRequest:
      description: Request body to fetch campaign stats.
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CampaignStatsRequest'
          examples:
            with-campaign-ids:
              summary: With Campaign IDs
              value:
                request_id: 'abc'
                campaign_ids:
                  - 6643773d4fe37fe7a10b718e
                  - 6645fbae1101e4c6611b15c7
                  - 67c1cfc8c1b46a5ad5022de7
                start_date: '2024-12-22'
                end_date: '2024-12-23'
                attribution_type: VIEW_THROUGH
                metric_type: TOTAL
            without-campaign-ids:
              summary: Without Campaign IDs
              value:
                request_id: 'abc'
                start_date: '2024-12-22'
                end_date: '2024-12-23'
                attribution_type: VIEW_THROUGH
                metric_type: TOTAL
  responses:
    Error400Stats:
      description: 'Bad Request. Possible issues include duplicates, invalid data types, or missing mandatory attributes.'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponseSimple'
          example:
            title: Invalid Field Value
            description: 'app_key - Some of the field values are invalid: app_key : None'
            code: wUcwPRZF
    Error401Stats:
      description: 'Unauthorized. Provide appropriate authentication credentials.'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponseSimple'
          example:
            title: Authentication required
            description: Invalid identity information found.
            code: wUcwPRZF
    Error403Stats:
      description: 'Forbidden. Your account does not have access to this feature.'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponseSimple'
          example:
            title: Forbidden Request
            description: null
            code: kmqLuuHM
    Error429Stats:
      description: 'Too many requests. The number of requests per minute has exceeded the rate limit (100 API calls/min/workspace).'
      content: {}
    Error500Stats:
      description: 'Internal Server Error. The system ran into an unexpected error.'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponseSimple'
          example:
            title: Server Error
            description: An unexpected error was encountered while processing this request. Please contact MoEngage Team
            code: jDTGSxjd
  schemas:
    CampaignStatsRequest:
      type: object
      required:
        - request_id
        - start_date
        - end_date
        - attribution_type
        - metric_type
      properties:
        request_id:
          type: string
          description: A request ID created by the user to track API calls.
        campaign_ids:
          type: array
          items:
            type: string
          description: A list of campaign IDs (up to 10 max per call).
          maxItems: 10
        start_date:
          type: string
          format: date
          description: The start date of the campaign in YYYY-MM-DD format.
          example: '2024-12-22'
        end_date:
          type: string
          format: date
          description: 'The campaign''s end date in YYYY-MM-DD format. The range between start and end dates should not exceed 30 days.'
          example: '2024-12-23'
        attribution_type:
          type: string
          description: The attribution type for conversion stats.
          enum:
            - VIEW_THROUGH
            - CLICK_THROUGH
            - IN_SESSION
            - TOTAL_CONVERSIONS
            - CLICK_CONVERSIONS
        offset:
          type: integer
          description: The position of a record in a dataset (for pagination). Default is 0.
          default: 0
        limit:
          type: integer
          description: The maximum number of campaigns to return. Default is 10, max is 10.
          default: 10
          maximum: 10
        metric_type:
          type: string
          description: Whether to show total or unique values for metrics.
          enum:
            - TOTAL
            - UNIQUE
    CampaignStatsResponse:
      type: object
      properties:
        response_id:
          type: string
          description: The response ID, which is the same as the request ID passed in the payload.
        total_campaigns:
          type: integer
          description: The total number of campaigns requested in the payload.
        current_page:
          type: integer
          description: The current page number.
        total_pages:
          type: integer
          description: The total number of pages.
        data:
          type: object
          description: 'A map where each key is a Campaign ID. The value is an array of campaign stat objects.'
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/CampaignStatsDetails'
    CampaignStatsDetails:
      type: object
      properties:
        platforms:
          $ref: '#/components/schemas/Platforms'
    Platforms:
      type: object
      description: 'An object where keys are platform names (e.g., "android", "EMAIL", "WEB").'
      additionalProperties:
        $ref: '#/components/schemas/PlatformStats'
    PlatformStats:
      type: object
      properties:
        locales:
          $ref: '#/components/schemas/Locales'
    Locales:
      type: object
      description: 'An object where keys are locale names (e.g., "all_locales").'
      additionalProperties:
        $ref: '#/components/schemas/LocaleStats'
    LocaleStats:
      type: object
      properties:
        variations:
          $ref: '#/components/schemas/Variations'
    Variations:
      type: object
      description: Stats broken down by variation and control groups.
      properties:
        all_variations:
          $ref: '#/components/schemas/VariationDetails'
        campaign_control_group:
          $ref: '#/components/schemas/VariationDetails'
        global_control_group:
          $ref: '#/components/schemas/VariationDetails'
    VariationDetails:
      type: object
      description: Contains all stats for a specific variation or control group.
      properties:
        performance_stats:
          $ref: '#/components/schemas/PerformanceStats'
        conversion_goal_stats:
          $ref: '#/components/schemas/ConversionGoalStats'
        delivery_funnel:
          $ref: '#/components/schemas/DeliveryFunnel'
        failure_breakdown:
          $ref: '#/components/schemas/FailureBreakdown'
    PerformanceStats:
      type: object
      description: Campaign performance metrics.
      properties:
        attempted:
          type: integer
        sent:
          type: integer
        failed:
          type: integer
        bounced:
          type: integer
        impression:
          type: integer
        click:
          type: integer
        opened:
          type: integer
        delivered:
          type: integer
        read:
          type: integer
        closed_click:
          type: integer
        unsubscribe:
          type: integer
        ctr:
          type: number
          format: double
        delivery_rate:
          type: number
          format: double
        read_rate:
          type: number
          format: double
        successfully_synced:
          type: integer
        sent_rate:
          type: number
          format: double
        failure_rate:
          type: number
          format: double
        eligible_users:
          type: integer
        complaint:
          type: integer
        hard_bounce:
          type: integer
        soft_bounce:
          type: integer
        open_rate:
          type: number
          format: double
        ctor:
          type: number
          format: double
        unsub_rate:
          type: number
          format: double
        bounce_rate:
          type: number
          format: double
        complaints_rate:
          type: number
          format: double
    ConversionGoalStats:
      type: object
      description: 'A map where keys are conversion goal names (e.g., "Goal 1").'
      additionalProperties:
        $ref: '#/components/schemas/ConversionGoal'
    ConversionGoal:
      type: object
      description: Stats for a specific conversion goal.
      properties:
        goal_name:
          type: string
        conversions:
          type: integer
        cvr:
          type: number
          format: double
        uplift:
          type: number
          format: double
        total:
          type: integer
        unique:
          type: integer
        revenue:
          type: number
        average_order_value:
          type: number
        average_revenue_per_user:
          type: number
        gcg_uplift:
          type: number
    DeliveryFunnel:
      type: object
      description: Funnel metrics for message delivery.
      properties:
        reachable_users_in_segment:
          type: integer
        segment_after_uninstall:
          type: integer
        after_fc:
          type: integer
        users_after_dup:
          type: integer
        sent:
          type: integer
        user_devices:
          type: integer
        impressions:
          type: integer
        active_device_token:
          type: integer
        after_invalid_removal:
          type: integer
        # Email-specific fields from sample
        total_user_in_segment:
          type: integer
        user_with_email:
          type: integer
        user_with_email_after__h_b:
          type: integer
        user_after_duplicate_removal:
          type: integer
        after_personalization_removal:
          type: integer
        delivered:
          type: integer
    FailureBreakdown:
      type: object
      description: 'A map where keys are failure reasons (e.g., "duplicate__emails_removed").'
      additionalProperties:
        type: integer
    ErrorResponseSimple:
      type: object
      description: Standard error response for the Stats API.
      properties:
        title:
          type: string
        description:
          type: string
          nullable: true
        code:
          type: string
    ErrorResponseCampaignReport:
      type: object
      description: Standard error response for the Campaign Report API 400 error.
      properties:
        error:
          type: object
          properties:
            attribute:
              type: string
            message:
              type: string
            type:
              type: string
              example: BAD REQUEST
            request_id:
              type: string